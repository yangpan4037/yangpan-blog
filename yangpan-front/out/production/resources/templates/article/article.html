<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
    <meta charset="UTF-8">
    <title>文章</title>
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <!--/* 公共css */-->
    <link th:replace="fragments/link"/>
    <!--/* 公共js */-->
    <script th:replace="fragments/script"/>
    <link rel="stylesheet" type="text/css" href="/css/article.css">
    <script type="text/javascript" src="/js/article/article.js"></script>
</head>
<body>

<!--/* header start */-->
<div th:replace="~{fragments/header :: header}"></div>
<!--/* header end */-->


<!-- article-body-wrap start -->
<div class="article-body-wrap article-page">
    <div class="media-auto-width article-body">
        <div class="article-body-left">
            <div class="article-body-content">
                <div class="article main">
                    <div class="article-plate-type">
                        <h2 class="title">[[${article.title}]]</h2>
                        <p class="sub-title">
                            <a class="category">[[${article.catalog.name}]]</a>
                            -
                            <a class="author">@[[${article.user.username}]]</a>
                            -
                            <span class="time">[[${#dates.format(article.createTime, 'yyyy-MM-dd HH:mm')}]]</span>
                        </p>
                        <p class="article-body">
                            [[${article.summary}]]
                        </p>
                        <div class="article-body" id="articleContent" th:utext="${article.htmlContent}"></div>
                    </div>
                    <div class="tag-contact">
                        <div class="tag">
                            <i class="iconfont">&#xe609;</i>

                            <a th:each="tag : ${#strings.arraySplit(article.tags , ',')}"
                               th:href="'/article/' + ${article.user.username}  + '/article?keyword='+ ${tag}">
                                [[${tag}]]
                            </a>
                        </div>
                        <div class="contact">
                            <a id="admireBtn" href="javascript:void(0);" th:class="${currentVote} == null ? '' : 'active'" th:if="${currentVote} == null">
                                <i class="iconfont">&#xe60c;</i>
                            </a>
                            <a id="admireBtn" href="javascript:void(0);" th:class="${currentVote} == null ? '' : 'active'" th:if="${currentVote}" th:attr="voteId=${currentVote.id}">
                                <i class="iconfont">&#xe60c;</i>
                            </a>
                            <a href="javascript:void(0);">
                                <i class="iconfont">&#xe673;</i>
                            </a>
                            <a href="javascript:void(0);">
                                <i class="iconfont">&#xe63a;</i>
                            </a>
                            <a href="javascript:void(0);">
                                <i class="iconfont">&#xe604;</i>
                            </a>
                        </div>
                    </div>
                    <div class="prev-next">
                        <a class="prev" th:href="'/article/'+${prevArticle.user.username}+'/article/'+${prevArticle.id}" th:if="${prevArticle} != null">«[[${prevArticle.title}]]</a>
                        <a class="next" th:href="'/article/'+${nextArticle.user.username}+'/article/'+${nextArticle.id}" th:if="${nextArticle} != null">[[${nextArticle.title}]]»</a>
                    </div>
                    <div id="articleCommentsWrap">
                        <div class="author-describe" th:each="comment,commentStat : ${commentList}" th:object="${comment}">
                            <div class="left">
                                <img src="../../static/images/defaut_face_01.jpeg" alt="头像">
                            </div>
                            <div class="right">
                                <div class="content">
                                    <p class="author">
                                        [[${commentStat.index} + 1]]楼  [[*{user.username}]] [[${#dates.format(comment.createTime, 'yyyy-MM-dd HH:mm')}]]
                                        <i id="deleteCommentBtn" class="iconfont" th:if="${commentOwner} eq *{user.username}" th:attr="commentId=*{id}" title="删除评论">&#xe60b;</i>
                                    </p>
                                    <p class="describe">[[*{content}]]</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="comment-wrap">
                        <div class="middle">
                            <textarea id="commentContent" placeholder="请发表你的评论或留言~"></textarea>
                        </div>
                        <div class="bottom">
                            <input id="commentBtn" type="button" value="发表评论"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="article-body-right">
            <div class="article-body-right-content">
                <div class="article-structure">
                    <p class="article-structure-title">文章目录</p>
                    <div class="article-structure-list" id="articleDirectory">

                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
<!-- article-body-wrap end -->

<!--/* footer start */-->
<div th:replace="~{fragments/footer :: footer}"></div>
<!--/* header end */-->

<script>
    var articleId = [[${article.id}]];
</script>
</body>
</html>